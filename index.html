<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Cyber I Ching Reading</title>
        <script src="https://js.puter.com/v2/"></script>
        <link rel="stylesheet" href="style.css"> <!-- ğŸ‘ˆ è¿™ä¸€è¡Œæ˜¯å…³é”® -->
      </head>
<body>
  <h1>I Ching Divination</h1>
  <p>Click the button below to cast two sets of trigrams and receive your hexagram.</p>
  <button onclick="startDivination()">Cast Hexagram</button>

  <div id="animationBox"></div>
  <div id="result"></div>

  <script>
const guaMap = {
  "111111": "ä¹¾ä¸ºå¤©",
  "000000": "å¤ä¸ºåœ°",
  "010001": "æ°´é›·å±¯",
  "100010": "å±±æ°´è’™",
  "010111": "æ°´å¤©éœ€",
  "111010": "å¤©æ°´è®¼",
  "000010": "åœ°æ°´å¸ˆ",
  "010000": "æ°´åœ°æ¯”",
  "110111": "é£å¤©å°ç•œ",
  "111011": "å¤©æ³½å±¥",
  "000111": "åœ°å¤©æ³°",
  "111000": "å¤©åœ°å¦",
  "111001": "å¤©ç«åŒäºº",
  "100111": "ç«å¤©å¤§æœ‰",
  "111100": "å¤©é›·æ— å¦„",
  "001111": "é›·å¤©å¤§å£®",
  "000100": "åœ°æ³½ä¸´",
  "001000": "å±±åœ°å‰¥",
  "011001": "é£æ°´æ¶£",
  "100110": "å±±æ³½æŸ",
  "000011": "åœ°ç«æ˜å¤·",
  "110000": "é›·åœ°è±«",
  "101111": "æ³½å¤©å¤¬",
  "111101": "å¤©é£å§¤",
  "000001": "æ³½åœ°èƒ",
  "100000": "å±±å¤©å¤§ç•œ",
  "100001": "å±±é›·é¢",
  "011110": "é£æ³½ä¸­å­š",
  "010100": "æ°´ç«æ—¢æµ",
  "001010": "ç«æ°´æœªæµ",
  "100101": "å±±æ³½æŸ",
  "101001": "æ³½å±±å’¸",
  "001101": "é›·é£æ’",
  "101100": "ç«é›·å™¬å—‘",
  "001110": "é›·ç«ä¸°",
  "011100": "ç«é£é¼",
  "000110": "æ³½é›·éš",
  "011000": "å±±é£è›Š",
  "110001": "é›·å±±å°è¿‡",
  "100011": "å±±æ³½å±¥",
  "111110": "å¤©åœ°å¦",
  "011111": "é£ç«å®¶äºº",
  "000101": "ç«æ³½ç½",
  "101000": "æ³½ç«é©",
  "100100": "ç«å±±æ—…",
  "001001": "å±±ç«è´²",
  "011011": "æ³½æ°´å›°",
  "110110": "é›·æ°´è§£",
  "001011": "å±±æ°´è’™",
  "110100": "é£æ°´æ¶£",
  "101101": "ç«æ°´æœªæµ",
  "101011": "æ°´ç«æ—¢æµ",
  "010110": "é›·æ³½å½’å¦¹",
  "011010": "æ³½é›·éš",
  "110010": "é£å±±æ¸",
  "010011": "å±±é£è›Š",
  "110011": "é£ç«å®¶äºº",
  "001100": "é›·æ³½å½’å¦¹",
  "011101": "æ³½å±±å’¸",
  "101110": "ç«é›·å™¬å—‘"
};




    // æ­£ç¡®çš„åŠ¨ç”»å¸§è·¯å¾„ï¼šDumpStack.log.tmp0025 ~ tmp0059
    const baseFrames = [];
for (let i = 25; i <= 59; i++) {
  const filename = `DumpStack.log.tmp${i.toString().padStart(4, '0')}.png`;
  baseFrames.push(filename);
}

// æˆ‘ä»¬åªæœ‰ "000", "001", "110", "111" æ–‡ä»¶å¤¹ï¼Œå…¶ä»–å¤ç”¨å·²æœ‰çš„åŠ¨ç”»æ–‡ä»¶å¤¹
const coinAnimations = {
  "000": baseFrames.map(f => `animation/000/${f}`),
  "001": baseFrames.map(f => `animation/001/${f}`),
  "010": baseFrames.map(f => `animation/001/${f}`), // fallback to 001
  "011": baseFrames.map(f => `animation/000/${f}`), // fallback to 000
  "100": baseFrames.map(f => `animation/111/${f}`), // fallback to 111
  "101": baseFrames.map(f => `animation/110/${f}`), // fallback to 110
  "110": baseFrames.map(f => `animation/110/${f}`),
  "111": baseFrames.map(f => `animation/111/${f}`)
};

    function flipCoin() {
      return Math.random() < 0.5 ? 0 : 1;
    }

    function getTrigramBinary() {
      let binary = "";
      for (let i = 0; i < 3; i++) {
        binary += flipCoin();
      }
      return binary;
    }

    function playAnimation(key, containerId = "animationBox", frameDelay = 100) {
      const container = document.getElementById(containerId);
      container.innerHTML = "";
      const frames = coinAnimations[key];
      if (!frames) return;

      let index = 0;
      const img = document.createElement("img");
      img.style.maxHeight = "180px";
      container.appendChild(img);

      const interval = setInterval(() => {
        if (index >= frames.length) {
          clearInterval(interval);
        } else {
          img.src = frames[index];
          index++;
        }
      }, frameDelay);
    }

    function startDivination() {
      const resultBox = document.getElementById('result');
      const upper = getTrigramBinary();
      const lower = getTrigramBinary();
      const full = upper + lower;
      const guaName = guaMap[full] || "æœªçŸ¥å¦è±¡";

      playAnimation(upper); // ä¸Šå¦å†³å®šåŠ¨ç”»

      resultBox.innerHTML = `
        <p>Generated Hexagram: <strong>${guaName}</strong> </p>
        <p>Consulting the Dao...</p>
      `;

      const prompt = `
Based on the following hexagram generated from digital coin tosses in an I Ching divination ritual, provide an accurate and traditional explanation from the Book of Changes:

- Upper trigram (binary): ${upper}
- Lower trigram (binary): ${lower}
- Combined hexagram (binary): ${full}
- Name of hexagram: ${guaName}

Please respond in the following structure:
1. å¦å (standard Chinese hexagram name, e.g., æ³½æ°´å›°)
2. å¦ä¹‰ (Traditional Chinese interpretation of this hexagram, accurate and concise)
3. Modern Advice (a short, practical takeaway or mindset reflection for today, based on this hexagram's meaning)

Do not invent new hexagrams or interpret freely. Your answer must be grounded in traditional I Ching scholarship. Your answer should be in English.
`;

      puter.ai.chat(prompt).then((reply) => {
        resultBox.innerHTML += `
          <hr>
          <div style="text-align: left; white-space: pre-wrap;">${reply}</div>
        `;
      });
    }
  </script>
</body>
</html>
